# Модель: Relationship

## 1. Описание

**`Relationship`** — это простая, но мощная встраиваемая модель, которая используется для описания результата проверки иерархической связи между двумя объектами.

Это **не самостоятельная сущность**, а, как правило, **модель-ответ** от бэкенда. Она не хранится в базе данных как отдельная таблица, а конструируется на лету в ответ на запрос.

## 2. Назначение и решаемые задачи

Основная цель — предоставить клиенту (например, фронтенду) исчерпывающую информацию о том, как два объекта соотносятся друг с другом в иерархии (например, в `Network` или `Tree`).

### Ключевые задачи:
- **Описание связи**: Содержит исходные `base_id` и `target_id`.
- **Предоставление результата**: В поле `state` содержится полный результат проверки, включая тип связи и дополнительные атрибуты.

## 3. Ключевые поля и концепции

- `base_id`: ID объекта, который мы считаем "точкой отсчета".
- `target_id`: ID объекта, чье положение относительно `base_id` мы хотим узнать.
- `state`: Поле типа `Relationship.State`. Это **вложенное сообщение**, которое содержит всю информацию о результате проверки:
  - `kind`: `enum State.Kind`, который описывает тип связи (`PERSONAL`, `TEAM`, `UPLINE` и т.д.).
  - `level_diff`: Необязательное поле. Для `TEAM` и `UPLINE` показывает, на сколько уровней один объект выше или ниже другого.
  - `branch_number`: Необязательное поле. Для `TEAM` показывает, в какой именно ветке у `base_id` находится `target_id`.

### Вложенный Enum: `State.Kind`
- **`PERSONAL`**: `base_id` и `target_id` — это один и тот же объект.
- **`TEAM`**: `target_id` находится "под" `base_id`.
- **`UPLINE`**: `target_id` находится "над" `base_id`.
- **`SIDEWAYS`**: Объекты в одной иерархии, но не по вертикали ("братья", "кузены").
- **`SEPARATE`**: Объекты в разных, не связанных иерархиях.

## 4. Сценарии использования (кейсы)

- **Проверка доступа**: Фронтенд хочет показать кнопку "Редактировать" только для пользователей из команды. Он запрашивает `Relationship` и проверяет, равен ли `state.kind` значению `TEAM`.
- **Отображение иерархии**: При построении дерева, фронтенд может использовать `state.level_diff` и `state.branch_number` для правильного позиционирования элементов.

## 5. Связи с другими моделями

Модель `Relationship` не имеет прямых связей. Она является результатом вычисления и используется в ответах API.
