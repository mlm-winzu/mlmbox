# Модель: Session

## 1. Описание

**`Session`** — это модель, представляющая собой запись об активной сессии пользователя в системе. Она создается при успешном входе и используется для аутентификации последующих запросов.

## 2. Назначение и решаемые задачи

Основная цель — управление доступом пользователя к системе и отслеживание активных входов для повышения безопасности и удобства.

## 3. Ключевые поля и концепции

- `id`: Уникальный числовой идентификатор сессии.
- `user_id`: ID пользователя, которому принадлежит сессия.
- `status`: Жизненный цикл сессии (`ACTIVE`, `EXPIRED`, `CANCELLED`, `REVOKED`).
- `device`: Вложенная структура с информацией об устройстве, IP и местоположении, с которого была начата сессия.
- `policy_id`: Обязательная ссылка на `SessionPolicy`, определяющую правила сессии.
- `last_activity_at`: Ключевое поле, которое бэкенд должен обновлять при каждом действии пользователя. Используется для проверки `inactivity_timeout_seconds` из политики.

## 4. Сценарии использования (кейсы)

- **Вход в систему**: Создается новая `Session` со статусом `ACTIVE`.
- **Выход (Logout)**: Статус сессии меняется на `CANCELLED`.
- **Просмотр активных сессий**: Пользователь может запросить все свои `Session` со статусом `ACTIVE`, чтобы увидеть, с каких устройств он вошел в систему, и принудительно завершить (изменить статус на `REVOKED`) любую из них.
- **Автоматическое завершение**: Бэкенд-задача периодически проверяет сессии и меняет статус на `EXPIRED` для тех, у кого `expires_at` или `last_activity_at` + `inactivity_timeout` в прошлом.

## 5. Связи с другими моделями

- **`User`**: `Session` **принадлежит** одному `User`.
- **`SessionPolicy`**: `Session` **управляется** одной политикой.
