# Сервис: GoogleAuthenticatorService

## 1. Описание

**`GoogleAuthenticatorService`** — это клиентский сервис для управления двухфакторной аутентификацией (2FA). Он спроектирован с упором на безопасность и использует утвержденный `ConfirmationService` для всех критически важных операций.

## 2. Общий сценарий использования (Workflow)

### Включение 2FA:
1.  Пользователь нажимает "Включить 2FA".
2.  Клиент вызывает `GoogleAuthenticatorService.Enable`.
3.  Бэкенд генерирует новый секретный ключ и создает `Confirmation` (сессию подтверждения). В `additional_data` этой сессии он помещает `secret_key`.
4.  Клиент получает эту `Confirmation`, отображает пользователю QR-код и поля для ввода (например, "код из приложения" и "текущий пароль").
5.  Пользователь заполняет поля, и клиент отправляет их через **`ConfirmationService.Confirm`**.
6.  Если подтверждение успешно, бэкенд активирует 2FA для пользователя.

### Отключение 2FA:
1.  Пользователь нажимает "Отключить 2FA".
2.  Клиент вызывает `GoogleAuthenticatorService.Disable`.
3.  Бэкенд создает `Confirmation`, которая требует для подтверждения, например, текущий пароль и код 2FA.
4.  Клиент отображает форму, пользователь ее заполняет и подтверждает через **`ConfirmationService.Confirm`**.
5.  Если все верно, бэкенд отключает 2FA.

## 3. Описание методов (RPC)

### `rpc Get(google.protobuf.Empty) returns (biconom.types.GoogleAuthenticator)`
- **Назначение**: Получить текущий статус 2FA для аутентифицированного пользователя.
- **Использование**: Позволяет клиенту понять, нужно ли отображать кнопку "Включить" или "Отключить", и показывать ли поле для ввода 2FA при входе.

### `rpc Enable(google.protobuf.Empty) returns (biconom.types.Confirmation)`
- **Назначение**: Инициировать процесс **включения** 2FA.
- **Использование**: Этот метод не включает 2FA напрямую. Он возвращает сессию подтверждения (`Confirmation`), которую необходимо завершить через `ConfirmationService`. Вся информация для настройки (QR-код) будет содержаться в `additional_data` этой сессии.

### `rpc Disable(google.protobuf.Empty) returns (biconom.types.Confirmation)`
- **Назначение**: Инициировать процесс **отключения** 2FA.
- **Использование**: Аналогично `Enable`, этот метод возвращает сессию подтверждения (`Confirmation`), которую нужно завершить для фактического отключения 2FA.
